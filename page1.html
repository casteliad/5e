<!DOCTYPE html>
<html>
<head>
  <title>Simple Skill Tree</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }

    header {
      background-color: #333;
      color: #fff;
      padding: 20px;
      text-align: center;
    }

    main {
      padding: 20px;
    }

    section {
      margin-bottom: 20px;
    }

    h2 {
      margin-top: 0;
    }

    .levelTier {
      margin-bottom: 20px;
    }

    .levelLabel {
      font-weight: bold;
      margin-bottom: 10px;
    }

    .levelNodes {
      display: flex;
      flex-wrap: wrap;
    }

    .skillNode {
      background-color: #b3ffb3;
      border: 1px solid #66cc66;
      border-radius: 5px;
      padding: 10px;
      margin-right: 10px;
      margin-bottom: 10px;
      cursor: pointer;
      position: relative;
    }

    .skillNode.locked {
      background-color: #ffcccc;
    }

    .tooltip {
      position: absolute;
      background-color: #fff;
      border: 1px solid #ccc;
      padding: 10px;
      display: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>Simple Skill Tree</h1>
  </header>
  <main>
    <section>
      <div id="skillTree"></div>
    </section>
  </main>
  <div class="tooltip"></div>
  <script>
    const skillTree = document.getElementById('skillTree');
    const tooltip = document.querySelector('.tooltip');

    fetch('data.json')
      .then(response => response.json())
      .then(json => {
        const optionalFeatures = json.optionalfeature;

        // Extract level prerequisites
        const levels = optionalFeatures.map(feature => feature.prerequisite[0].level);
        const minLevel = Math.min(...levels);
        const maxLevel = Math.max(...levels);

        // Create level tiers
        for (let level = minLevel; level <= maxLevel; level++) {
          const levelTier = document.createElement('div');
          levelTier.classList.add('levelTier');
          levelTier.innerHTML = `<div class="levelLabel">Level ${level}</div><div class="levelNodes"></div>`;
          skillTree.appendChild(levelTier);
        }

        // Add features to level tiers
        optionalFeatures.forEach(feature => {
          const level = feature.prerequisite[0].level;
          const levelNodes = skillTree.querySelector(`.levelTier:nth-child(${level - minLevel + 1}) .levelNodes`);

          const featureNode = document.createElement('div');
          featureNode.classList.add('skillNode');
          featureNode.innerHTML = `
            <h3>${feature.name}</h3>
            <p>${feature.source}</p>
            <hr>
            <ul>
              <li><strong>Level:</strong> ${level}</li>
              <li><strong>Prerequisites:</strong> ${getPrerequisites(feature.prerequisite)}</li>
              <li><strong>Type:</strong> ${feature.featureType[0]}</li>
            </ul>
          `;

          featureNode.addEventListener('mouseover', () => {
            tooltip.textContent = feature.entries[0];
            tooltip.style.display = 'block';
          });

          featureNode.addEventListener('mouseout', () => {
            tooltip.style.display = 'none';
          });

          featureNode.addEventListener('mousemove', (event) => {
            tooltip.style.top = (event.clientY + 10) + 'px';
            tooltip.style.left = (event.clientX + 10) + 'px';
          });

          levelNodes.appendChild(featureNode);
        });
      });

    function getPrerequisites(prerequisite) {
      let prerequisites = [];
      if (prerequisite && prerequisite.length > 0) {
        if (prerequisite[0].level) {
          prerequisites.push(`${prerequisite[0].level}st level`);
        }
        if (prerequisite[0].otherSummary && prerequisite[0].otherSummary.entry) {
          prerequisites.push(prerequisite[0].otherSummary.entry);
        }
        if (prerequisite[0].otherSummary && prerequisite[0].otherSummary.entrySummary) {
          prerequisites.push(prerequisite[0].otherSummary.entrySummary);
        }
      }
      return prerequisites.join(', ');
    }
  </script>
</body>
</html>
